<include file="Usercenter:header" />
<body>
<include file="Usercenter:aside" />
<!-- main -->
<div class="main">
    <include file="Usercenter:top" />

    <!--content-->
    <div class="content">
        <!--{$title}-->
        <div class="profile">
            <div class="box">
                <div class="box_t">
                    <h3>{$title}</h3>
                </div>
            </div>
            <div class="box_c">
                <form action="{:U('Delivery/doEdit')}" method="post">
                    <fieldset>
                        <div class="box_c_item">
                            <label class="l_title">公司名：</label>
                            <input class="text_input w300" type="text" name="consignor" placeholder="请输入公司名" value="{$delivery.company}">
                            <div class="clear"></div>
                        </div>
                        <div class="box_c_item">
                            <label class="l_title">* 联系人：</label>
                            <input class="text_input w300" type="text" name="consignor" placeholder="请输入联系人" value="{$delivery.consignor}">
                            <div class="clear"></div>
                        </div>
                        <div class="box_c_item">
                            <label class="l_title">* 国家：</label>
                            <select class="w300" id="country" name="country">
                                <foreach name="country_list" item="v">
                                    <option value="{$v.id}" <if condition="$v.id eq $delivery['country_id']">selected="selected"</if>>{$v.ename} / {$v.name}</option>
                                </foreach>
                            </select>
                            <div class="clear"></div>
                        </div>
                        <div class="box_c_item">
                            <label class="l_title">省：</label>
                            <input class="text_input w300" type="text" name="state" placeholder="请输入省"  value="{$delivery.state}">
                            <div class="clear"></div>
                        </div>
                        <div class="box_c_item">
                            <label class="l_title">* 市：</label>
                            <input class="text_input w300" type="text" name="city" placeholder="请输入市"  value="{$delivery.city}">
                            <div class="clear"></div>
                        </div>
                        <div class="box_c_item">
                            <label class="l_title">* 具体地址：</label>
                            <input class="text_input w300" type="text" name="detail_address" placeholder="请输入具体地址"  value="{$delivery.detail_address}">
                            <div class="clear"></div>
                        </div>
                        <div class="box_c_item">
                            <label class="l_title">* 邮编：</label>
                            <input class="text_input w300" type="text" name="postal_code" placeholder="请输入邮编" value="{$delivery.postal_code}">
                            <div class="clear"></div>
                        </div>
                        <div class="box_c_item">
                            <label class="l_title">* 手机：</label>
                            <input class="text_input w300" type="text" name="mobile" placeholder="请输入手机" value="{$delivery.mobile}">
                            <div class="clear"></div>
                        </div>
                        <div class="box_c_item">
                            <label class="l_title">座机：</label>
                            <input class="text_input w300" type="text" name="phone" placeholder="请输入座机" value="{$delivery.phone}">
                            <div class="clear"></div>
                        </div>
                        <div class="box_c_item">
                            <label class="l_title">出口商代码：</label>
                            <input class="text_input w300" type="text" name="exporter_code" placeholder="请输入出口商代码" value="{$delivery.exporter_code}">
                            <div class="clear"></div>
                        </div>
                        <div class="box_c_item">
                            <label class="l_title">* 有效证件号码：</label>
                            <input class="text_input w300" type="text" name="certificate_num" placeholder="请输入有效证件号码" value="{$delivery.certificate_num}">
                            <div class="clear"></div>
                        </div>
                        <div class="clear"></div>
                        <div class="box_c_item" style="width: 980px;">
                            <!--<div class="fl add_product_img select-image" id="select-image-1" style="display: none;position: relative;margin-top: 0px;margin-left: 50px;width: 400px; height: 240px">-->
                                <!--<input type="hidden" name="certificate1_url" id="certificate1_url" value="{$delivery.certificate1_url}" />-->
                                <!--<input name="mypic" type="file" id="certificate-upload-1" value="" style="cursor: pointer;width: 408px; height: 248px;opacity: 0;position: absolute;top: 0; right: 0;">-->
                            <!--</div>-->
                            <div id="show-image-1" class="fl product_img_show select-image" style="position: relative; width: 408px;margin-top: 0px;margin-left: 50px;margin-right: 10px; margin-bottom: 5px;">
                                <input type="hidden" name="certificate1_url" id="certificate1_url" value="{$delivery.certificate1_url}" />
                                <img src="{$delivery.certificate1_url}" alt="有效证件正面"  width='408' height='248'/>
                                <input name="mypic" type="file" id="change-certificate-upload-1" value="{$delivery.certificate1_url}" style="cursor: pointer;width: 408px; height: 248px;opacity: 0;position: absolute;top: 0; right: 0;">
                            </div>
                            <!--<div class="fl add_product_img select-image" id="select-image-2" style="display: none;position: relative;position: relative;margin-top: 0px;margin-left: 10px;width: 400px; height: 240px">-->
                                <!--<input type="hidden" name="certificate2_url" id="certificate2_url" value="{$delivery.certificate2_url}"/>-->
                                <!--<input name="mypic" type="file" id="certificate-upload-2" value="{$delivery.certificate2_url}" style="cursor: pointer;width: 408px; height: 248px;opacity: 0;position: absolute;top: 0; right: 0;"/>-->
                            <!--</div>-->
                            <div id="show-image-2" class="fl product_img_show select-image" style="position: relative; width: 408px;position: relative;margin-top: 0px;margin-left: 50px;margin-right: 10px; margin-bottom: 5px;">
                                <input type="hidden" name="certificate2_url" id="certificate2_url" value="{$delivery.certificate2_url}"/>
                                <img src="{$delivery.certificate2_url}" alt="有效证件反面"  width='408' height='248'/>
                                <input name="mypic" type="file" id="change-certificate-upload-2" value="" style="cursor: pointer;width: 408px; height: 248px;opacity: 0;position: absolute;top: 0; right: 0;">
                            </div>
                        </div>
                        <div class="clear"></div>
                        <div class="box_c_item" id="show-result-1" style="display: none;">
                            <label class="l_title">上传中...</label>
                            <div class="clear"></div>
                        </div>
                        <div class="box_c_item" style="margin-top: 20px">
                            <label class="l_title">默认：</label>
                            <input type="radio" name="default" value="1"  <if condition="$delivery.is_default eq 1">checked="checked"</if>/>是&nbsp;
                            <input type="radio" name="default" value="0"  <if condition="$delivery.is_default eq 0">checked="checked"</if>/>否
                            <div class="clear"></div>
                        </div>
                        <div class="box_c_item">
                            <label class="l_title"></label>
                            <input type="hidden" name="id" value="{$delivery.id}" />
                            <button class="btn btn_commit" type="submit">确认</button> &nbsp;<a href="{:U('Delivery/index')}" class="btn btn_cancel">取消</a>
                            <div class="clear"></div>
                        </div>
                    </fieldset>
                </form>
                <div class="clear"></div>
            </div>
        </div>
        <!--END 个人信息-->
    </div>
    <!--END content-->
</div>
<!-- END main -->
<script type="text/javascript" src="__PUBLIC__/usercenter/js/base.js"></script>
<script type="text/javascript" src="__PUBLIC__/select2/4.0.3/js/select2.full.min.js"></script>
<script type="text/javascript" src="__PUBLIC__/select2/4.0.3/js/i18n/zh-CN.js"></script>
<script type="text/javascript">
    $(function () {
        menu1("#ud3", "#ud3 a", ".coin_3 a.nav_top_item");
    });
</script>
<script type="text/javascript">
    $(function () {

        $("#country").select2({
            matcher: matchStart
        });

        //上传
        $("#certificate-upload-1").wrap('<form id="myupload-1" style="width:408px;height:248px" class="fl" action="{:U(GROUP_NAME. '/Public/upload', array('tb' => 2))}" method="post" enctype="multipart/form-data"></form>');
        $('#myupload-1').append('<i class="icon">&#xe629;</i> <p>上传有效证件正面</p>');
        $("#certificate-upload-1").change(function() {
            upload_certificate_1('myupload-1');
        });

        $('#change-certificate-upload-1').wrap('<form id="change-myupload-1" style="" class="fl" action="{:U(GROUP_NAME. '/Public/upload', array('tb' => 2))}" method="post" enctype="multipart/form-data"></form>');
        $("#change-certificate-upload-1").change(function() {
            upload_certificate_1('change-myupload-1');
        });


        $("#certificate-upload-2").wrap('<form id="myupload-2" style="width:408px;height:248px" class="fl" action="{:U(GROUP_NAME. '/Public/upload', array('tb' => 2))}" method="post" enctype="multipart/form-data"></form>');
        $('#myupload-2').append('<i class="icon">&#xe629;</i> <p>上传有效证件反面</p>');
        $("#certificate-upload-2").change(function() {
            upload_certificate_2('myupload-2');
        });

        $('#change-certificate-upload-2').wrap('<form id="change-myupload-2" style="" class="fl" action="{:U(GROUP_NAME. '/Public/upload', array('tb' => 2))}" method="post" enctype="multipart/form-data"></form>');
        $("#change-certificate-upload-2").change(function() {
            upload_certificate_2('change-myupload-2');
        });

    });

    function upload_certificate_1(key) {
        console.log(key);
//            console.log($("#certificate-upload-1").val());
//            return;
        if($("#certificate-upload-1").val() == "") {
            console.log('没东西');
            return;
        }
        $("#" + key).ajaxSubmit({
            dataType:  'json',
            beforeSend: function() {
                $('#show-result-1 label').empty();
//                    $('#show-result-1 label').html("上传中...");
                $('#show-result-1').show();
            },
            success: function(data) {
                //litpic_tip.html("<b>"+data.title+"("+data.size+"k)</b> <span class='delimg' rel='"+data.url+"'>删除</span>");
                if(data.state == 'SUCCESS'){
                    $('#show-result-1 label').html("有效证件正面 上传成功("+data.size+"k)");
                    var img = data.url;
                    var timg = data.turl;
//                        $('#show-image-1').empty();
                    $('#show-image-1 img').attr("src", img);
                    $("#certificate1_url").val(img);
                    $('#show-image-1').show();
                    $('#select-image-1').hide();
                }else {
                    $('#show-result-1 label').html(data.state);
                }
//                    btn.html("上传");

            },
            error:function(xhr){
                btn.html("上传失败");
                litpic_tip.html(xhr);
            }
        });
    }

    function upload_certificate_2(key){
        console.log(key);
//            console.log($("#certificate-upload-1").val());
//            return;
        if($("#certificate-upload-2").val() == "") return;
        $("#" + key).ajaxSubmit({
            dataType:  'json',
            beforeSend: function() {
                $('#show-result-1 label').empty();
//                    $('#show-result-2 label').html("上传中...");
                $('#show-result-1').show();
            },
            success: function(data) {
                //litpic_tip.html("<b>"+data.title+"("+data.size+"k)</b> <span class='delimg' rel='"+data.url+"'>删除</span>");
                if(data.state == 'SUCCESS'){
                    $('#show-result-1 label').html("有效证件反面 上传成功("+data.size+"k)");
                    var img = data.url;
                    var timg = data.turl;
                    $('#show-image-2 img').attr("src", img);
                    $("#certificate2_url").val(img);
                    $('#show-image-2').show();
                    $('#select-image-2').hide();
                }else {
                    $('#show-result-1 label').html(data.state);
                }
//                    btn.html("上传");

            },
            error:function(xhr){
                btn.html("上传失败");
                litpic_tip.html(xhr);
            }
        });
    }


</script>
</body>
</html>